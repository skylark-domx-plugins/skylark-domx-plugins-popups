/**
 * skylark-domx-plugins-popups - The skylark popup utility library for dom api extension.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(e,t){var i=t.define,require=t.require,n="function"==typeof i&&i.amd,s=!n&&"undefined"!=typeof exports;if(!n&&!i){var o={};i=t.define=function(e,t,i){"function"==typeof i?(o[e]={factory:i,deps:t.map(function(t){return function(e,t){if("."!==e[0])return e;var i=t.split("/"),n=e.split("/");i.pop();for(var s=0;s<n.length;s++)"."!=n[s]&&(".."==n[s]?i.pop():i.push(n[s]));return i.join("/")}(t,e)}),resolved:!1,exports:null},require(e)):o[e]={factory:null,resolved:!0,exports:i}},require=t.require=function(e){if(!o.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=o[e];if(!module.resolved){var i=[];module.deps.forEach(function(e){i.push(require(e))}),module.exports=module.factory.apply(t,i)||null,module.resolved=!0}return module.exports}}if(!i)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(e,require){e("skylark-domx-plugins-popups/popups",["skylark-langx-ns"],function(e){var t=[];return e.attach("domx.plugins.popups",{around:function(e){var t=geom.size(popup),i=t.width,n=t.height,s=geom.height(e),o=e.ownerDocument,r=o.documentElement,l=r.clientWidth+geom.scrollLeft(o),d=r.clientHeight+geom.scrollTop(o),a=geom.pagePosition(e),h=a.left,c=a.top;return c+=s,h-=Math.min(h,h+i>l&&l>i?Math.abs(h+i-l):0),{top:c-=Math.min(c,c+n>d&&d>n?Math.abs(n+s-0):0),bottom:a.bottom,left:h,right:a.right,width:a.width,height:a.height}},open:function(e,t){t.around},close:function(e){var i=0;if(e){for(var n=t.length-1;n>=0;n--)if(t[n].popup==e){i=t.length-n;break}}else i=t.length;for(var n=0;n<i;n++){var s=t.pop(),o=s.popup;o.hide&&o.hide()}}})}),e("skylark-domx-plugins-popups/calcOffset",["skylark-domx-geom","./popups"],function(e,t){return t.calcOffset=function(t,i){var n=e.size(t),s=n.width,o=n.height,r=e.height(i),l=t.ownerDocument,d=l.documentElement,a=d.clientWidth+e.scrollLeft(l),h=d.clientHeight+e.scrollTop(l),c=e.pagePosition(i),u=c.left,p=c.top;return p+=r,u-=Math.min(u,u+s>a&&a>s?Math.abs(u+s-a):0),{top:p-=Math.min(p,p+o>h&&h>o?Math.abs(o+r-0):0),bottom:c.bottom,left:u,right:c.right,width:c.width,height:c.height}}}),e("skylark-domx-plugins-popups/Dropdown",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./popups"],function(e,t,i,n,s,o,r,l){"use strict";var d=".dropdown-backdrop",a='[data-toggle="dropdown"]',h=r.Plugin.inherit({klassName:"Dropdown",pluginName:"domx.dropdown",options:{selectors:{toggler:'[data-toggle="dropdown"],.dropdown-menu'}},_construct:function(e,t){this.overrided(e,t);var i=this.$element=o(this._elm);i.on("click.dropdown",this.toggle),i.on("keydown.dropdown",this.options.selectors.toggler,this.keydown)},toggle:function(e){var t=o(this);if(!t.is(".disabled, :disabled")){var n=c(t),s=n.hasClass("open");if(u(),!s){"ontouchstart"in document.documentElement&&!n.closest(".navbar-nav").length&&o(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(o(this)).on("click",u);var r={relatedTarget:this};if(n.trigger(e=i.create("show.dropdown",r)),e.isDefaultPrevented())return;t.trigger("focus").attr("aria-expanded","true"),n.toggleClass("open").trigger(i.create("shown.dropdown",r))}return!1}},keydown:function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var t=o(this);if(e.preventDefault(),e.stopPropagation(),!t.is(".disabled, :disabled")){var i=c(t),n=i.hasClass("open");if(!n&&27!=e.which||n&&27==e.which)return 27==e.which&&i.find(a).trigger("focus"),t.trigger("click");var s=i.find(".dropdown-menu li:not(.disabled):visible a");if(s.length){var r=s.index(e.target);38==e.which&&r>0&&r--,40==e.which&&r<s.length-1&&r++,~r||(r=0),s.eq(r).trigger("focus")}}}}});function c(e){var t=e.attr("data-target");t||(t=(t=e.attr("href"))&&/#[A-Za-z]/.test(t)&&t.replace(/.*(?=#[^\s]*$)/,""));var i=t&&o(t);return i&&i.length?i:e.parent()}function u(e){e&&3===e.which||(o(d).remove(),o(a).each(function(){var t=o(this),s=c(t),r={relatedTarget:this};s.hasClass("open")&&(e&&"click"==e.type&&/input|textarea/i.test(e.target.tagName)&&n.contains(s[0],e.target)||(s.trigger(e=i.create("hide.dropdown",r)),e.isDefaultPrevented()||(t.attr("aria-expanded","false"),s.removeClass("open").trigger(i.create("hidden.dropdown",r)))))}))}return o(document).on("click.dropdown.data-api",u).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}),r.register(h),l.Dropdown=h}),e("skylark-domx-plugins-popups/ComboBox",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./popups","./Dropdown"],function(e,t,i,n,s,o,r,l,d){var a=r.Plugin.inherit({klassName:"ComboBox",pluginName:"domx.combobox",options:{autoResizeMenu:!0,filterOnKeypress:!1,showOptionsOnKeypress:!1,filter:function(e,t,i){var n=0;i.$dropMenu.find(".empty-indicator").remove(),e.each(function(e){var i=o(this),s=o(this).text().trim();i.removeClass(),s===t?(i.addClass("text-success"),n++):s.substr(0,t.length)===t?(i.addClass("text-info"),n++):i.addClass("hidden")}),0===n&&i.$dropMenu.append('<li class="empty-indicator text-muted"><em>No Matches</em></li>')}},_construct:function(t,i){this.overrided(t,i),this.$element=this.$(),this.$dropMenu=this.$element.find(".dropdown-menu"),this.$input=this.$element.find("input"),this.$button=this.$element.find(".btn"),this.$button.plugin("domx.dropdown"),this.$inputGroupBtn=this.$element.find(".input-group-btn"),this.$element.on("click.lark","a",e.proxy(this.itemclicked,this)),this.$element.on("change.lark","input",e.proxy(this.inputchanged,this)),this.$element.on("shown.bs.dropdown",e.proxy(this.menuShown,this)),this.$input.on("keyup.lark",e.proxy(this.keypress,this)),this.setDefaultSelection();var n=this.$dropMenu.children("li");0===n.length&&this.$button.addClass("disabled"),this.options.filterOnKeypress&&this.options.filter(this.$dropMenu.find("li"),this.$input.val(),this)},_destroy:function(){return this.$element.remove(),this.$element.find("input").each(function(){o(this).attr("value",o(this).val())}),this.$element[0].outerHTML},doSelect:function(e){void 0!==e[0]?(this.$element.find("li.selected:first").removeClass("selected"),this.$selectedItem=e,this.$selectedItem.addClass("selected"),this.$input.val(this.$selectedItem.text().trim())):(this.$selectedItem=null,this.$element.find("li.selected:first").removeClass("selected"))},clearSelection:function(){this.$selectedItem=null,this.$input.val(""),this.$dropMenu.find("li").removeClass("selected")},menuShown:function(){this.options.autoResizeMenu&&this.resizeMenu()},resizeMenu:function(){var e=this.$element.outerWidth();this.$dropMenu.outerWidth(e)},selectedItem:function(){var t=this.$selectedItem,i={};if(t){var n=this.$selectedItem.text().trim();i=e.mixin({text:n},this.$selectedItem.data())}else i={text:this.$input.val().trim(),notFound:!0};return i},selectByText:function(e){var t=o([]);this.$element.find("li").each(function(){if((this.textContent||this.innerText||o(this).text()||"").trim().toLowerCase()===(e||"").trim().toLowerCase())return t=o(this),!1}),this.doSelect(t)},selectByValue:function(e){var t='li[data-value="'+e+'"]';this.selectBySelector(t)},selectByIndex:function(e){var t="li:eq("+e+")";this.selectBySelector(t)},selectBySelector:function(e){var t=this.$element.find(e);this.doSelect(t)},setDefaultSelection:function(){var e="li[data-selected=true]:first",t=this.$element.find(e);t.length>0&&(this.selectBySelector(e),t.removeData("selected"),t.removeAttr("data-selected"))},enable:function(){this.$element.removeClass("disabled"),this.$input.removeAttr("disabled"),this.$button.removeClass("disabled")},disable:function(){this.$element.addClass("disabled"),this.$input.attr("disabled",!0),this.$button.addClass("disabled")},itemclicked:function(e){this.$selectedItem=o(e.target).parent(),this.$input.val(this.$selectedItem.text().trim()).trigger("change",{synthetic:!0});var t=this.selectedItem();this.$element.trigger("changed.lark",t),e.preventDefault(),this.$element.find(".dropdown-toggle").focus()},keypress:function(e){var t=38===e.which||40===e.which||37===e.which||39===e.which;if(this.options.showOptionsOnKeypress&&!this.$inputGroupBtn.hasClass("open")&&(this.$button.plugin("domx.dropdown").toggle(),this.$input.focus()),13===e.which){e.preventDefault();var i=this.$dropMenu.find("li.selected").text().trim();i.length>0?this.selectByText(i):this.selectByText(this.$input.val()),this.$inputGroupBtn.removeClass("open")}else if(27===e.which)e.preventDefault(),this.clearSelection(),this.$inputGroupBtn.removeClass("open");else if(this.options.showOptionsOnKeypress&&(40===e.which||38===e.which)){e.preventDefault();var n=this.$dropMenu.find("li.selected");n.length>0&&(n=40===e.which?n.next(":not(.hidden)"):n.prev(":not(.hidden)")),0===n.length&&(n=40===e.which?this.$dropMenu.find("li:not(.hidden):first"):this.$dropMenu.find("li:not(.hidden):last")),this.doSelect(n)}this.options.filterOnKeypress&&!t&&this.options.filter(this.$dropMenu.find("li"),this.$input.val(),this),this.previousKeyPress=e.which},inputchanged:function(e,t){var i=o(e.target).val();if(t&&t.synthetic)this.selectByText(i);else{this.selectByText(i);var n=this.selectedItem();0===n.text.length&&(n={text:i}),this.$element.trigger("changed.lark",n)}}});return a.prototype.getValue=a.prototype.selectedItem,r.register(a),l.ComboBox=a}),e("skylark-domx-plugins-popups/SelectList",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./popups","./Dropdown"],function(e,t,i,n,s,o,r,l,d){var a=r.Plugin.inherit({klassName:"SelectList",pluginName:"domx.selectlist",options:{emptyLabelHTML:'<li data-value=""><a href="#">No items</a></li>'},_construct:function(t,i){this.overrided(t,i),this.$element=this.$(),this.$button=this.$element.find(".btn.dropdown-toggle"),this.$hiddenField=this.$element.find(".hidden-field"),this.$label=this.$element.find(".selected-label"),this.$dropdownMenu=this.$element.find(".dropdown-menu"),this.$button.plugin("domx.dropdown"),this.$element.on("click.selectlist",".dropdown-menu a",e.proxy(this.itemClicked,this)),this.setDefaultSelection(),"auto"!==this.options.resize&&"auto"!==this.$element.attr("data-resize")||this.resize();var n=this.$dropdownMenu.children("li");0===n.length&&(this.disable(),this.doSelect(o(this.options.emptyLabelHTML))),this.$element.on("shown.dropdown",function(){var e=o(this);o(document).on("keypress.selectlist",function(t){var i=String.fromCharCode(t.which);e.find("li").each(function(e,t){if(o(t).text().charAt(0).toLowerCase()===i)return o(t).children("a").focus(),!1})})}),this.$element.on("hide.dropdown",function(){o(document).off("keypress.selectlist")})},_destroy:function(){return this.$element.remove(),this.$element[0].outerHTML},doSelect:function(e){var t;this.$selectedItem=t=e,this.$hiddenField.val(this.$selectedItem.attr("data-value")),this.$label.html(o(this.$selectedItem.children()[0]).html()),this.$element.find("li").each(function(){t.is(o(this))?o(this).attr("data-selected",!0):o(this).removeData("selected").removeAttr("data-selected")})},itemClicked:function(e){this.$element.trigger("clicked.selectlist",this.$selectedItem),e.preventDefault(),o(e.currentTarget).parent("li").is(".disabled, :disabled")||(o(e.target).parent().is(this.$selectedItem)||this.itemChanged(e),this.$element.find(".dropdown-toggle").focus())},itemChanged:function(e){this.doSelect(o(e.target).closest("li"));var t=this.selectedItem();this.$element.trigger("changed.selectlist",t)},resize:function(){var e=0,t=0,i=o("<div/>").addClass("selectlist-sizer");Boolean(o(document).find("html").hasClass("fuelux"))?o(document.body).append(i):o(".fuelux:first").append(i),i.append(this.$element.clone()),this.$element.find("a").each(function(){i.find(".selected-label").text(o(this).text()),t=i.find(".selectlist").outerWidth(),(t+=i.find(".sr-only").outerWidth())>e&&(e=t)}),e<=1||(this.$button.css("width",e),this.$dropdownMenu.css("width",e),i.remove())},selectedItem:function(){var t=this.$selectedItem.text();return e.mixin({text:t},this.$selectedItem.data())},selectByText:function(e){var t=o([]);this.$element.find("li").each(function(){if((this.textContent||this.innerText||o(this).text()||"").toLowerCase()===(e||"").toLowerCase())return t=o(this),!1}),this.doSelect(t)},selectByValue:function(e){var t='li[data-value="'+e+'"]';this.selectBySelector(t)},selectByIndex:function(e){var t="li:eq("+e+")";this.selectBySelector(t)},selectBySelector:function(e){var t=this.$element.find(e);this.doSelect(t)},setDefaultSelection:function(){var e=this.$element.find("li[data-selected=true]").eq(0);0===e.length&&(e=this.$element.find("li").has("a").eq(0)),this.doSelect(e)},enable:function(){this.$element.removeClass("disabled"),this.$button.removeClass("disabled")},disable:function(){this.$element.addClass("disabled"),this.$button.addClass("disabled")}});return a.prototype.getValue=a.prototype.selectedItem,r.register(a),l.SelectList=a}),e("skylark-domx-plugins-popups/main",["./popups","./calcOffset","./Dropdown","./ComboBox","./SelectList"],function(e){return e}),e("skylark-domx-plugins-popups",["skylark-domx-plugins-popups/main"],function(e){return e})}(i),!n){var r=require("skylark-langx-ns");s?module.exports=r:t.skylarkjs=r}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-domx-plugins-popups.js.map
