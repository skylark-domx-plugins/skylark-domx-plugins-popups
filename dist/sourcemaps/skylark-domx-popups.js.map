{"version":3,"sources":["skylark-domx-popups.js"],"names":["define","skylark","stack","attach","around","ref","dpSize","geom","size","popup","dpWidth","width","dpHeight","height","refHeight","doc","ownerDocument","docElem","documentElement","viewWidth","clientWidth","scrollLeft","viewHeight","clientHeight","scrollTop","offset","pagePosition","offsetLeft","left","offsetTop","top","Math","min","abs","bottom","right","open","options","close","count","i","length","pop","popup1","hide","popups","calcOffset","langx","browser","eventer","noder","$","plugins","backdrop","toggle","Dropdown","Plugin","inherit","klassName","pluginName","selectors","toggler","_construct","elm","this","overrided","$el","$element","_elm","on","keydown","e","$this","is","$parent","getParent","isActive","hasClass","clearMenus","document","closest","createElement","addClass","insertAfter","relatedTarget","trigger","create","isDefaultPrevented","attr","toggleClass","test","which","target","tagName","preventDefault","stopPropagation","find","$items","index","eq","selector","replace","parent","remove","each","type","contains","removeClass","register","SelectList","emptyLabelHTML","$button","$hiddenField","$label","$dropdownMenu","plugin","proxy","itemClicked","setDefaultSelection","resize","items","children","disable","doSelect","key","String","fromCharCode","idx","item","text","charAt","toLowerCase","focus","off","_destroy","outerHTML","$item","$selectedItem","val","html","removeData","removeAttr","currentTarget","itemChanged","data","selectedItem","newWidth","sizer","Boolean","body","append","clone","outerWidth","css","txt","mixin","selectByText","textContent","innerText","selectByValue","value","selectBySelector","selectByIndex","has","enable","prototype","getValue","main"],"mappings":"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","file":"../skylark-domx-popups.js","sourcesContent":["define('skylark-domx-popups/popups',[\r\n\t\"skylark-langx-ns\"\r\n],function(skylark){\r\n\r\n\tvar stack = [];\r\n\r\n\r\n\r\n    /**\r\n    * get the offset below/above and left/right element depending on screen position\r\n    * Thanks https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.datepicker.js\r\n    */\r\n    function around(ref) {\r\n        var extraY = 0;\r\n        var dpSize = geom.size(popup);\r\n        var dpWidth = dpSize.width;\r\n        var dpHeight = dpSize.height;\r\n        var refHeight = geom.height(ref);\r\n        var doc = ref.ownerDocument;\r\n        var docElem = doc.documentElement;\r\n        var viewWidth = docElem.clientWidth + geom.scrollLeft(doc);\r\n        var viewHeight = docElem.clientHeight + geom.scrollTop(doc);\r\n        var offset = geom.pagePosition(ref);\r\n        var offsetLeft = offset.left;\r\n        var offsetTop = offset.top;\r\n\r\n        offsetTop += refHeight;\r\n\r\n        offsetLeft -=\r\n            Math.min(offsetLeft, (offsetLeft + dpWidth > viewWidth && viewWidth > dpWidth) ?\r\n            Math.abs(offsetLeft + dpWidth - viewWidth) : 0);\r\n\r\n        offsetTop -=\r\n            Math.min(offsetTop, ((offsetTop + dpHeight > viewHeight && viewHeight > dpHeight) ?\r\n            Math.abs(dpHeight + refHeight - extraY) : extraY));\r\n\r\n        return {\r\n            top: offsetTop,\r\n            bottom: offset.bottom,\r\n            left: offsetLeft,\r\n            right: offset.right,\r\n            width: offset.width,\r\n            height: offset.height\r\n        };\r\n    }\r\n\r\n\r\n\t/*\r\n\t * Popup the ui elment at the specified position\r\n\t * @param popup  element to display\r\n\t * @param options\r\n\t *  - around {HtmlEleent}\r\n\t *  - at {x,y}\r\n\t *  - parent {}\r\n\t */\r\n\r\n\tfunction open(popup,options) {\r\n\t\tif (options.around) {\r\n\t\t\t//A DOM node that should be used as a reference point for placing the pop-up. \r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/*\r\n\t * Close specified popup and any popups that it parented.\r\n\t * If no popup is specified, closes all popups.\r\n     */\r\n\tfunction close(popup) {\r\n\t\tvar count = 0;\r\n\r\n\t\tif (popup) {\r\n\t\t\tfor (var i= stack.length-1; i>=0; i--) {\r\n\t\t\t\tif (stack[i].popup == popup) {\r\n\t\t\t\t\tcount = stack.length - i; \r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcount = stack.length;\r\n\t\t}\r\n\t\tfor (var i=0; i<count ; i++ ) {\r\n\t\t\tvar top = stack.pop(),\r\n\t\t\t\tpopup1 = top.popup;\r\n\t\t\tif (popup1.hide) {\r\n\t\t\t\tpopup1.hide();\r\n\t\t\t} else {\r\n\r\n\t\t\t}\r\n\r\n\t\t} \r\n\t}\r\n\treturn skylark.attach(\"domx.popups\",{\r\n\t\taround,\r\n\t\topen,\r\n\t\tclose\r\n\t});\r\n});\ndefine('skylark-domx-popups/calcOffset',[\r\n\t\"skylark-domx-geom\",\r\n\t\"./popups\"\r\n],function(\r\n\tgeom,\r\n\tpopups\r\n){\r\n    /**\r\n    * checkOffset - get the offset below/above and left/right element depending on screen position\r\n    * Thanks https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.datepicker.js\r\n    */\r\n    function calcOffset(popup, ref) {\r\n        var extraY = 0;\r\n        var dpSize = geom.size(popup);\r\n        var dpWidth = dpSize.width;\r\n        var dpHeight = dpSize.height;\r\n        var refHeight = geom.height(ref);\r\n        var doc = popup.ownerDocument;\r\n        var docElem = doc.documentElement;\r\n        var viewWidth = docElem.clientWidth + geom.scrollLeft(doc);\r\n        var viewHeight = docElem.clientHeight + geom.scrollTop(doc);\r\n        var offset = geom.pagePosition(ref);\r\n        var offsetLeft = offset.left;\r\n        var offsetTop = offset.top;\r\n\r\n        offsetTop += refHeight;\r\n\r\n        offsetLeft -=\r\n            Math.min(offsetLeft, (offsetLeft + dpWidth > viewWidth && viewWidth > dpWidth) ?\r\n            Math.abs(offsetLeft + dpWidth - viewWidth) : 0);\r\n\r\n        offsetTop -=\r\n            Math.min(offsetTop, ((offsetTop + dpHeight > viewHeight && viewHeight > dpHeight) ?\r\n            Math.abs(dpHeight + refHeight - extraY) : extraY));\r\n\r\n        return {\r\n            top: offsetTop,\r\n            bottom: offset.bottom,\r\n            left: offsetLeft,\r\n            right: offset.right,\r\n            width: offset.width,\r\n            height: offset.height\r\n        };\r\n    }\r\n\r\n    return popups.calcOffset = calcOffset;\r\n\t\t\r\n});\ndefine('skylark-domx-popups/Dropdown',[\n  \"skylark-langx/langx\",\n  \"skylark-domx-browser\",\n  \"skylark-domx-eventer\",\n  \"skylark-domx-noder\",\n  \"skylark-domx-geom\",\n  \"skylark-domx-query\",\n  \"skylark-domx-plugins\",\n  \"./popups\"\n],function(langx,browser,eventer,noder,geom,$,plugins,popups){\n\n  'use strict';\n\n  // DROPDOWN CLASS DEFINITION\n  // =========================\n\n  var backdrop = '.dropdown-backdrop';\n  var toggle   = '[data-toggle=\"dropdown\"]';\n\n  var Dropdown = plugins.Plugin.inherit({\n    klassName: \"Dropdown\",\n\n    pluginName : \"domx.dropdown\",\n\n    options : {\n      \"selectors\" : {\n        \"toggler\" : '[data-toggle=\"dropdown\"],.dropdown-menu'\n      }\n\n    },\n\n    _construct : function(elm,options) {\n      this.overrided(elm,options);\n\n      var $el = this.$element = $(this._elm);\n      $el.on('click.dropdown', this.toggle);\n      $el.on('keydown.dropdown', this.options.selectors.toggler,this.keydown);\n    },\n\n    toggle : function (e) {\n      var $this = $(this)\n\n      if ($this.is('.disabled, :disabled')) {\n        return;\n      }\n\n      var $parent  = getParent($this)\n      var isActive = $parent.hasClass('open');\n\n      clearMenus()\n\n      if (!isActive) {\n        if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {\n          // if mobile we use a backdrop because click events don't delegate\n          $(document.createElement('div'))\n            .addClass('dropdown-backdrop')\n            .insertAfter($(this))\n            .on('click', clearMenus)\n        }\n\n        var relatedTarget = { relatedTarget: this }\n        $parent.trigger(e = eventer.create('show.dropdown', relatedTarget))\n\n        if (e.isDefaultPrevented()) {\n          return;\n        }\n\n        $this\n          .trigger('focus')\n          .attr('aria-expanded', 'true')\n\n        $parent\n          .toggleClass('open')\n          .trigger(eventer.create('shown.dropdown', relatedTarget))\n      }\n\n      return false\n    },\n\n    keydown : function (e) {\n      if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) {\n        return;\n      }\n\n      var $this = $(this);\n\n      e.preventDefault()\n      e.stopPropagation()\n\n      if ($this.is('.disabled, :disabled')) {\n        return;\n      }\n\n      var $parent  = getParent($this)\n      var isActive = $parent.hasClass('open')\n\n      if (!isActive && e.which != 27 || isActive && e.which == 27) {\n        if (e.which == 27) $parent.find(toggle).trigger('focus')\n        return $this.trigger('click')\n      }\n\n      var desc = ' li:not(.disabled):visible a'\n      var $items = $parent.find('.dropdown-menu' + desc)\n\n      if (!$items.length) return\n\n      var index = $items.index(e.target)\n\n      if (e.which == 38 && index > 0)                 index--         // up\n      if (e.which == 40 && index < $items.length - 1) index++         // down\n      if (!~index)                                    index = 0\n\n      $items.eq(index).trigger('focus');\n    }\n\n  });\n\n  function getParent($this) {\n    var selector = $this.attr('data-target')\n\n    if (!selector) {\n      selector = $this.attr('href')\n      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\\s]*$)/, '') // strip for ie7\n    }\n\n    var $parent = selector && $(selector);\n\n    return $parent && $parent.length ? $parent : $this.parent();\n  }\n\n  function clearMenus(e) {\n    if (e && e.which === 3) return\n    $(backdrop).remove()\n    $(toggle).each(function () {\n      var $this         = $(this)\n      var $parent       = getParent($this)\n      var relatedTarget = { relatedTarget: this }\n\n      if (!$parent.hasClass('open')) return\n\n      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && noder.contains($parent[0], e.target)) return\n\n      $parent.trigger(e = eventer.create('hide.dropdown', relatedTarget))\n\n      if (e.isDefaultPrevented()) return\n\n      $this.attr('aria-expanded', 'false')\n      $parent.removeClass('open').trigger(eventer.create('hidden.dropdown', relatedTarget))\n    })\n  }\n\n\n\n  // APPLY TO STANDARD DROPDOWN ELEMENTS\n  // ===================================\n  $(document)\n    .on('click.dropdown.data-api', clearMenus)\n    .on('click.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() });\n\n  plugins.register(Dropdown);\n\n  return popups.Dropdown = Dropdown;\n\n});\n\ndefine('skylark-domx-popups/SelectList',[\n  \"skylark-langx/langx\",\n  \"skylark-domx-browser\",\n  \"skylark-domx-eventer\",\n  \"skylark-domx-noder\",\n  \"skylark-domx-geom\",\n  \"skylark-domx-query\",\n  \"skylark-domx-plugins\",\n  \"./popups\",\n  \"./Dropdown\"\n],function(langx,browser,eventer,noder,geom,$,plugins,popups,Dropdown){\n\n\n\t// SELECT CONSTRUCTOR AND PROTOTYPE\n\n\tvar SelectList = plugins.Plugin.inherit({\n\t\tklassName: \"SelectList\",\n\n\t\tpluginName : \"domx.selectlist\",\n\t\n\t\toptions : {\n\t\t\temptyLabelHTML: '<li data-value=\"\"><a href=\"#\">No items</a></li>'\n\n\t\t},\n\n    \t_construct : function(elm,options) {\n      \t\tthis.overrided(elm,options);\n      \t\tthis.$element = $(this._elm);\n\t\t\t//this.options = langx.mixin({}, $.fn.selectlist.defaults, options);\n\n\n\t\t\tthis.$button = this.$element.find('.btn.dropdown-toggle');\n\t\t\tthis.$hiddenField = this.$element.find('.hidden-field');\n\t\t\tthis.$label = this.$element.find('.selected-label');\n\t\t\tthis.$dropdownMenu = this.$element.find('.dropdown-menu');\n\n\t\t\tthis.$button.plugin(\"domx.dropdown\");\n\n\t\t\tthis.$element.on('click.selectlist', '.dropdown-menu a', langx.proxy(this.itemClicked, this));\n\t\t\tthis.setDefaultSelection();\n\n\t\t\tif (this.options.resize === 'auto' || this.$element.attr('data-resize') === 'auto') {\n\t\t\t\tthis.resize();\n\t\t\t}\n\n\t\t\t// if selectlist is empty or is one item, disable it\n\t\t\tvar items = this.$dropdownMenu.children('li');\n\t\t\tif( items.length === 0) {\n\t\t\t\tthis.disable();\n\t\t\t\tthis.doSelect( $(this.options.emptyLabelHTML));\n\t\t\t}\n\n\t\t\t// support jumping focus to first letter in dropdown when key is pressed\n\t\t\tthis.$element.on('shown.dropdown', function () {\n\t\t\t\t\tvar $this = $(this);\n\t\t\t\t\t// attach key listener when dropdown is shown\n\t\t\t\t\t$(document).on('keypress.selectlist', function(e){\n\n\t\t\t\t\t\t// get the key that was pressed\n\t\t\t\t\t\tvar key = String.fromCharCode(e.which);\n\t\t\t\t\t\t// look the items to find the first item with the first character match and set focus\n\t\t\t\t\t\t$this.find(\"li\").each(function(idx,item){\n\t\t\t\t\t\t\tif ($(item).text().charAt(0).toLowerCase() === key) {\n\t\t\t\t\t\t\t\t$(item).children('a').focus();\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// unbind key event when dropdown is hidden\n\t\t\tthis.$element.on('hide.dropdown', function () {\n\t\t\t\t\t$(document).off('keypress.selectlist');\n\t\t\t});\n\t\t},\n\n\t\t_destroy: function () {\n\t\t\tthis.$element.remove();\n\t\t\t// any external bindings\n\t\t\t// [none]\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\t\t\t// returns string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\tdoSelect: function ($item) {\n\t\t\tvar $selectedItem;\n\t\t\tthis.$selectedItem = $selectedItem = $item;\n\n\t\t\tthis.$hiddenField.val(this.$selectedItem.attr('data-value'));\n\t\t\tthis.$label.html($(this.$selectedItem.children()[0]).html());\n\n\t\t\t// clear and set selected item to allow declarative init state\n\t\t\t// unlike other controls, selectlist's value is stored internal, not in an input\n\t\t\tthis.$element.find('li').each(function () {\n\t\t\t\tif ($selectedItem.is($(this))) {\n\t\t\t\t\t$(this).attr('data-selected', true);\n\t\t\t\t} else {\n\t\t\t\t\t$(this).removeData('selected').removeAttr('data-selected');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\titemClicked: function (e) {\n\t\t\tthis.$element.trigger('clicked.selectlist', this.$selectedItem);\n\n\t\t\te.preventDefault();\n\t\t\t// ignore if a disabled item is clicked\n\t\t\tif ($(e.currentTarget).parent('li').is('.disabled, :disabled')) { return; }\n\n\t\t\t// is clicked element different from currently selected element?\n\t\t\tif (!($(e.target).parent().is(this.$selectedItem))) {\n\t\t\t\tthis.itemChanged(e);\n\t\t\t}\n\n\t\t\t// return focus to control after selecting an option\n\t\t\tthis.$element.find('.dropdown-toggle').focus();\n\t\t},\n\n\t\titemChanged: function (e) {\n\t\t\t//selectedItem needs to be <li> since the data is stored there, not in <a>\n\t\t\tthis.doSelect($(e.target).closest('li'));\n\n\t\t\t// pass object including text and any data-attributes\n\t\t\t// to onchange event\n\t\t\tvar data = this.selectedItem();\n\t\t\t// trigger changed event\n\t\t\tthis.$element.trigger('changed.selectlist', data);\n\t\t},\n\n\t\tresize: function () {\n\t\t\tvar width = 0;\n\t\t\tvar newWidth = 0;\n\t\t\tvar sizer = $('<div/>').addClass('selectlist-sizer');\n\n\n\t\t\tif (Boolean($(document).find('html').hasClass('fuelux'))) {\n\t\t\t\t// default behavior for fuel ux setup. means fuelux was a class on the html tag\n\t\t\t\t$(document.body).append(sizer);\n\t\t\t} else {\n\t\t\t\t// fuelux is not a class on the html tag. So we'll look for the first one we find so the correct styles get applied to the sizer\n\t\t\t\t$('.fuelux:first').append(sizer);\n\t\t\t}\n\n\t\t\tsizer.append(this.$element.clone());\n\n\t\t\tthis.$element.find('a').each(function () {\n\t\t\t\tsizer.find('.selected-label').text($(this).text());\n\t\t\t\tnewWidth = sizer.find('.selectlist').outerWidth();\n\t\t\t\tnewWidth = newWidth + sizer.find('.sr-only').outerWidth();\n\t\t\t\tif (newWidth > width) {\n\t\t\t\t\twidth = newWidth;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (width <= 1) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$button.css('width', width);\n\t\t\tthis.$dropdownMenu.css('width', width);\n\n\t\t\tsizer.remove();\n\t\t},\n\n\t\tselectedItem: function () {\n\t\t\tvar txt = this.$selectedItem.text();\n\t\t\treturn langx.mixin({\n\t\t\t\ttext: txt\n\t\t\t}, this.$selectedItem.data());\n\t\t},\n\n\t\tselectByText: function (text) {\n\t\t\tvar $item = $([]);\n\t\t\tthis.$element.find('li').each(function () {\n\t\t\t\tif ((this.textContent || this.innerText || $(this).text() || '').toLowerCase() === (text || '').toLowerCase()) {\n\t\t\t\t\t$item = $(this);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.doSelect($item);\n\t\t},\n\n\t\tselectByValue: function (value) {\n\t\t\tvar selector = 'li[data-value=\"' + value + '\"]';\n\t\t\tthis.selectBySelector(selector);\n\t\t},\n\n\t\tselectByIndex: function (index) {\n\t\t\t// zero-based index\n\t\t\tvar selector = 'li:eq(' + index + ')';\n\t\t\tthis.selectBySelector(selector);\n\t\t},\n\n\t\tselectBySelector: function (selector) {\n\t\t\tvar $item = this.$element.find(selector);\n\t\t\tthis.doSelect($item);\n\t\t},\n\n\t\tsetDefaultSelection: function () {\n\t\t\tvar $item = this.$element.find('li[data-selected=true]').eq(0);\n\n\t\t\tif ($item.length === 0) {\n\t\t\t\t$item = this.$element.find('li').has('a').eq(0);\n\t\t\t}\n\n\t\t\tthis.doSelect($item);\n\t\t},\n\n\t\tenable: function () {\n\t\t\tthis.$element.removeClass('disabled');\n\t\t\tthis.$button.removeClass('disabled');\n\t\t},\n\n\t\tdisable: function () {\n\t\t\tthis.$element.addClass('disabled');\n\t\t\tthis.$button.addClass('disabled');\n\t\t}\n\n\t});\t\n\n\n\tSelectList.prototype.getValue = SelectList.prototype.selectedItem;\n\n\n    plugins.register(SelectList);\n\n\treturn popups.SelectList = SelectList;\n});\n\ndefine('skylark-domx-popups/main',[\r\n\t\"./popups\",\r\n\t\"./calcOffset\",\r\n\t\"./Dropdown\",\r\n\t\"./SelectList\"\r\n],function(popups){\r\n\treturn popups;\r\n});\ndefine('skylark-domx-popups', ['skylark-domx-popups/main'], function (main) { return main; });\n\n"]}