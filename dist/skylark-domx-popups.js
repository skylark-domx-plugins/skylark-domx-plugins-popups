/**
 * skylark-domx-popups - The skylark popup utility library for dom api extension.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(e,t){var i=t.define,require=t.require,n="function"==typeof i&&i.amd,o=!n&&"undefined"!=typeof exports;if(!n&&!i){var s={};i=t.define=function(e,t,i){"function"==typeof i?(s[e]={factory:i,deps:t.map(function(t){return function(e,t){if("."!==e[0])return e;var i=t.split("/"),n=e.split("/");i.pop();for(var o=0;o<n.length;o++)"."!=n[o]&&(".."==n[o]?i.pop():i.push(n[o]));return i.join("/")}(t,e)}),resolved:!1,exports:null},require(e)):s[e]={factory:null,resolved:!0,exports:i}},require=t.require=function(e){if(!s.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=s[e];if(!module.resolved){var i=[];module.deps.forEach(function(e){i.push(require(e))}),module.exports=module.factory.apply(t,i)||null,module.resolved=!0}return module.exports}}if(!i)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(e,require){e("skylark-domx-popups/popups",["skylark-langx-ns"],function(e){var t=[];return e.attach("domx.popups",{around:function(e){var t=geom.size(popup),i=t.width,n=t.height,o=geom.height(e),s=e.ownerDocument,r=s.documentElement,l=r.clientWidth+geom.scrollLeft(s),a=r.clientHeight+geom.scrollTop(s),d=geom.pagePosition(e),h=d.left,c=d.top;return c+=o,h-=Math.min(h,h+i>l&&l>i?Math.abs(h+i-l):0),{top:c-=Math.min(c,c+n>a&&a>n?Math.abs(n+o-0):0),bottom:d.bottom,left:h,right:d.right,width:d.width,height:d.height}},open:function(e,t){t.around},close:function(e){var i=0;if(e){for(var n=t.length-1;n>=0;n--)if(t[n].popup==e){i=t.length-n;break}}else i=t.length;for(var n=0;n<i;n++){var o=t.pop(),s=o.popup;s.hide&&s.hide()}}})}),e("skylark-domx-popups/calcOffset",["skylark-domx-geom","./popups"],function(e,t){return t.calcOffset=function(t,i){var n=e.size(t),o=n.width,s=n.height,r=e.height(i),l=t.ownerDocument,a=l.documentElement,d=a.clientWidth+e.scrollLeft(l),h=a.clientHeight+e.scrollTop(l),c=e.pagePosition(i),u=c.left,p=c.top;return p+=r,u-=Math.min(u,u+o>d&&d>o?Math.abs(u+o-d):0),{top:p-=Math.min(p,p+s>h&&h>s?Math.abs(s+r-0):0),bottom:c.bottom,left:u,right:c.right,width:c.width,height:c.height}}}),e("skylark-domx-popups/Dropdown",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins","./popups"],function(e,t,i,n,o,s,r,l){"use strict";var a=".dropdown-backdrop",d='[data-toggle="dropdown"]',h=r.Plugin.inherit({klassName:"Dropdown",pluginName:"domx.dropdown",options:{selectors:{toggler:'[data-toggle="dropdown"],.dropdown-menu'}},_construct:function(e,t){this.overrided(e,t);var i=this.$element=s(this._elm);i.on("click.dropdown",this.toggle),i.on("keydown.dropdown",this.options.selectors.toggler,this.keydown)},toggle:function(e){var t=s(this);if(!t.is(".disabled, :disabled")){var n=c(t),o=n.hasClass("open");if(u(),!o){"ontouchstart"in document.documentElement&&!n.closest(".navbar-nav").length&&s(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(s(this)).on("click",u);var r={relatedTarget:this};if(n.trigger(e=i.create("show.dropdown",r)),e.isDefaultPrevented())return;t.trigger("focus").attr("aria-expanded","true"),n.toggleClass("open").trigger(i.create("shown.dropdown",r))}return!1}},keydown:function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var t=s(this);if(e.preventDefault(),e.stopPropagation(),!t.is(".disabled, :disabled")){var i=c(t),n=i.hasClass("open");if(!n&&27!=e.which||n&&27==e.which)return 27==e.which&&i.find(d).trigger("focus"),t.trigger("click");var o=i.find(".dropdown-menu li:not(.disabled):visible a");if(o.length){var r=o.index(e.target);38==e.which&&r>0&&r--,40==e.which&&r<o.length-1&&r++,~r||(r=0),o.eq(r).trigger("focus")}}}}});function c(e){var t=e.attr("data-target");t||(t=(t=e.attr("href"))&&/#[A-Za-z]/.test(t)&&t.replace(/.*(?=#[^\s]*$)/,""));var i=t&&s(t);return i&&i.length?i:e.parent()}function u(e){e&&3===e.which||(s(a).remove(),s(d).each(function(){var t=s(this),o=c(t),r={relatedTarget:this};o.hasClass("open")&&(e&&"click"==e.type&&/input|textarea/i.test(e.target.tagName)&&n.contains(o[0],e.target)||(o.trigger(e=i.create("hide.dropdown",r)),e.isDefaultPrevented()||(t.attr("aria-expanded","false"),o.removeClass("open").trigger(i.create("hidden.dropdown",r)))))}))}return s(document).on("click.dropdown.data-api",u).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}),r.register(h),l.Dropdown=h}),e("skylark-domx-popups/SelectList",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins","./popups","./Dropdown"],function(e,t,i,n,o,s,r,l,a){var d=r.Plugin.inherit({klassName:"SelectList",pluginName:"domx.selectlist",options:{emptyLabelHTML:'<li data-value=""><a href="#">No items</a></li>'},_construct:function(t,i){this.overrided(t,i),this.$element=s(this._elm),this.$button=this.$element.find(".btn.dropdown-toggle"),this.$hiddenField=this.$element.find(".hidden-field"),this.$label=this.$element.find(".selected-label"),this.$dropdownMenu=this.$element.find(".dropdown-menu"),this.$button.plugin("domx.dropdown"),this.$element.on("click.selectlist",".dropdown-menu a",e.proxy(this.itemClicked,this)),this.setDefaultSelection(),"auto"!==this.options.resize&&"auto"!==this.$element.attr("data-resize")||this.resize();var n=this.$dropdownMenu.children("li");0===n.length&&(this.disable(),this.doSelect(s(this.options.emptyLabelHTML))),this.$element.on("shown.dropdown",function(){var e=s(this);s(document).on("keypress.selectlist",function(t){var i=String.fromCharCode(t.which);e.find("li").each(function(e,t){if(s(t).text().charAt(0).toLowerCase()===i)return s(t).children("a").focus(),!1})})}),this.$element.on("hide.dropdown",function(){s(document).off("keypress.selectlist")})},_destroy:function(){return this.$element.remove(),this.$element[0].outerHTML},doSelect:function(e){var t;this.$selectedItem=t=e,this.$hiddenField.val(this.$selectedItem.attr("data-value")),this.$label.html(s(this.$selectedItem.children()[0]).html()),this.$element.find("li").each(function(){t.is(s(this))?s(this).attr("data-selected",!0):s(this).removeData("selected").removeAttr("data-selected")})},itemClicked:function(e){this.$element.trigger("clicked.selectlist",this.$selectedItem),e.preventDefault(),s(e.currentTarget).parent("li").is(".disabled, :disabled")||(s(e.target).parent().is(this.$selectedItem)||this.itemChanged(e),this.$element.find(".dropdown-toggle").focus())},itemChanged:function(e){this.doSelect(s(e.target).closest("li"));var t=this.selectedItem();this.$element.trigger("changed.selectlist",t)},resize:function(){var e=0,t=0,i=s("<div/>").addClass("selectlist-sizer");Boolean(s(document).find("html").hasClass("fuelux"))?s(document.body).append(i):s(".fuelux:first").append(i),i.append(this.$element.clone()),this.$element.find("a").each(function(){i.find(".selected-label").text(s(this).text()),t=i.find(".selectlist").outerWidth(),(t+=i.find(".sr-only").outerWidth())>e&&(e=t)}),e<=1||(this.$button.css("width",e),this.$dropdownMenu.css("width",e),i.remove())},selectedItem:function(){var t=this.$selectedItem.text();return e.mixin({text:t},this.$selectedItem.data())},selectByText:function(e){var t=s([]);this.$element.find("li").each(function(){if((this.textContent||this.innerText||s(this).text()||"").toLowerCase()===(e||"").toLowerCase())return t=s(this),!1}),this.doSelect(t)},selectByValue:function(e){var t='li[data-value="'+e+'"]';this.selectBySelector(t)},selectByIndex:function(e){var t="li:eq("+e+")";this.selectBySelector(t)},selectBySelector:function(e){var t=this.$element.find(e);this.doSelect(t)},setDefaultSelection:function(){var e=this.$element.find("li[data-selected=true]").eq(0);0===e.length&&(e=this.$element.find("li").has("a").eq(0)),this.doSelect(e)},enable:function(){this.$element.removeClass("disabled"),this.$button.removeClass("disabled")},disable:function(){this.$element.addClass("disabled"),this.$button.addClass("disabled")}});return d.prototype.getValue=d.prototype.selectedItem,r.register(d),l.SelectList=d}),e("skylark-domx-popups/main",["./popups","./calcOffset","./Dropdown","./SelectList"],function(e){return e}),e("skylark-domx-popups",["skylark-domx-popups/main"],function(e){return e})}(i),!n){var r=require("skylark-langx-ns");o?module.exports=r:t.skylarkjs=r}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-domx-popups.js.map
